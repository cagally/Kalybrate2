{
  "task_id": "writing-rules_hard_3",
  "prompt": "Set up a complete hookify rule system for a React project that warns about console.log in .tsx files, blocks dangerous bash commands, prevents editing node_modules, and shows a completion checklist. Organize everything properly.",
  "difficulty": "hard",
  "model": "claude-3-5-haiku-20241022",
  "response": "I'll help you set up a comprehensive Hookify rule system for a React project with the specified requirements. I'll create four different rule files and a Python script to generate them.\n\nHere's the Python script to create the Hookify rules:\n\n```python\nimport os\n\n# Use the provided OUTPUT_DIR\nOUTPUT_DIR = \"/var/folders/2w/xl3jf3j148n2fy4gkgrx_ymh0000gn/T/kalybrate_task_rrxl4d0t\"\n\n# Ensure .claude directory exists\nclaude_dir = os.path.join(OUTPUT_DIR, '.claude')\nos.makedirs(claude_dir, exist_ok=True)\n\n# 1. Console.log Warning Rule for TypeScript React Files\nconsole_log_rule = '''---\nname: warn-console-log-tsx\nenabled: true\nevent: file\nconditions:\n  - field: file_path\n    operator: regex_match\n    pattern: \\.tsx?$\n  - field: new_text\n    operator: contains\n    pattern: console\\.log\n---\n\n\u26a0\ufe0f **Console.log Detected in TypeScript/React File**\n\nLeaving console.log in production code is not recommended:\n- Exposes potential debugging information\n- Can impact performance\n- May leak sensitive data\n\n**Best Practices:**\n- Remove console.log before committing\n- Use proper logging libraries for production\n- Consider using `debug` package for conditional logging\n'''\n\n# 2. Dangerous Bash Commands Rule\ndangerous_bash_rule = '''---\nname: block-dangerous-bash-commands\nenabled: true\nevent: bash\npattern: (rm\\s+-rf|sudo\\s+|dd\\s+if=|mkfs|chmod\\s+777)\naction: block\n---\n\n\ud83d\uded1 **Dangerous Bash Command Blocked**\n\nThe command you're attempting to run is potentially destructive or risky.\n\n**Blocked Commands Include:**\n- Recursive delete (`rm -rf`)\n- Sudo without careful review\n- Disk operations (`dd if=`)\n- Filesystem formatting (`mkfs`)\n- Overly permissive chmod (777)\n\n**Safety Recommendations:**\n- Double-check command intent\n- Use specific, limited commands\n- Confirm before running system-level operations\n'''\n\n# 3. Prevent node_modules Editing Rule\nnode_modules_rule = '''---\nname: prevent-node-modules-edit\nenabled: true\nevent: file\nconditions:\n  - field: file_path\n    operator: contains\n    pattern: node_modules/\naction: block\n---\n\n\ud83d\udeab **Editing node_modules is Prohibited**\n\nYou are attempting to directly edit files in the node_modules directory.\n\n**Why This is Blocked:**\n- Manually editing node_modules can break dependencies\n- Changes will be overwritten by package manager\n- Leads to inconsistent and unpredictable behavior\n\n**Recommended Workflow:**\n- Update dependencies via package.json\n- Use `npm install` or `yarn install`\n- If modification is necessary, create a custom package\n'''\n\n# 4. Project Completion Checklist Rule\ncompletion_rule = '''---\nname: project-completion-checklist\nenabled: true\nevent: stop\npattern: .*\n---\n\n\ud83c\udfc1 **Project Completion Checklist**\n\nBefore considering this task complete, verify:\n\nDevelopment Checklist:\n- [ ] All tests are passing\n- [ ] Code has been linted\n- [ ] No console.log statements remain\n- [ ] TypeScript types are correct\n- [ ] Performance optimizations reviewed\n\nBuild & Deployment:\n- [ ] Production build successful\n- [ ] Environment variables configured\n- [ ] Dependencies up-to-date\n- [ ] No critical vulnerabilities (check with npm audit)\n\nDocumentation:\n- [ ] README updated\n- [ ] Inline code comments added/reviewed\n- [ ] Component/function documentation complete\n\nReview:\n- [ ] Peer code review completed\n- [ ] Meets project coding standards\n'''\n\n# Write rules to files\nrules = [\n    ('hookify.console-log-warning.local.md', console_log_rule),\n    ('hookify.dangerous-bash-commands.local.md', dangerous_bash_rule),\n    ('hookify.node-modules-protection.local.md', node_modules_rule),\n    ('hookify.project-completion-checklist.local.md', completion_rule)\n]\n\nfor filename, content in rules:\n    filepath = os.path.join(claude_dir, filename)\n    with open(filepath, 'w') as f:\n        f.write(content)\n\nprint(f\"Hookify rules created in {claude_dir}\")\n```\n\nThis script does the following:\n\n1. Creates a `.claude` directory in the specified output directory\n2. Defines four comprehensive Hookify rules:\n   - Warns about console.log in TypeScript/React files\n   - Blocks dangerous bash commands\n   - Prevents editing node_modules\n   - Shows a project completion checklist\n3. Writes each rule to a separate `.local.md` file in the `.claude` directory\n\nWhen you run this script, it will generate the Hookify rules with descriptive warnings and actionable guidance. The rules cover various aspects of React project development, from code quality to system safety.\n\nKey features:\n- Uses regex and conditions for precise matching\n- Provides detailed, actionable messages\n- Covers different event types (file, bash, stop)\n- Organized in a clean, readable format\n\nWould you like me to elaborate on any part of the rule system or explain how these rules would work in practice?",
  "criteria_results": {
    "file_created": false,
    "file_valid": false,
    "file_has_content": false
  },
  "passed": false,
  "tokens": {
    "input": 2764,
    "output": 1297,
    "total": 4061
  },
  "execution_time": 22.823960781097412,
  "error": null,
  "timestamp": "2026-01-01T09:07:00.105724"
}