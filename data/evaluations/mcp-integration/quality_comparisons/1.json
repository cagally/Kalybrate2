{
  "prompt": "How can I add OAuth authentication to my Claude plugin for connecting to third-party services?",
  "baseline_response": "I want to help you implement OAuth authentication for your Claude plugin securely. Here's a general approach:\n\n1. OAuth Flow Steps\n- Register your application with the service provider\n- Obtain client credentials (client ID and client secret)\n- Implement authorization request\n- Handle callback/redirect \n- Exchange authorization code for access token\n- Store and refresh tokens securely\n\n2. Recommended Implementation Pattern\n```python\nclass OAuthHandler:\n    def __init__(self, client_id, client_secret, redirect_uri):\n        self.client_id = client_id\n        self.client_secret = client_secret\n        self.redirect_uri = redirect_uri\n\n    def generate_authorization_url(self):\n        # Create OAuth authorization request URL\n        params = {\n            'client_id': self.client_id,\n            'redirect_uri': self.redirect_uri,\n            'response_type': 'code',\n            'scope': 'requested_permissions'\n        }\n        return authorization_endpoint + '?' + urlencode(params)\n\n    def exchange_code_for_token(self, authorization_code):\n        # Token exchange request\n        token_response = requests.post(token_endpoint, {\n            'client_id': self.client_id,\n            'client_secret': self.client_secret,\n            'code': authorization_code,\n            'grant_type': 'authorization_code',\n            'redirect_uri': self.redirect_uri\n        })\n        return token_response.json()\n```\n\n3. Security Recommendations\n- Use HTTPS\n- Securely store tokens \n- Implement token refresh mechanism\n- Validate and sanitize all inputs\n- Use environment variables for credentials\n\nWould you like me to elaborate on any part of the OAuth implementation?",
  "baseline_tokens": {
    "input": 25,
    "output": 410,
    "total": 435
  },
  "skill_response": "I'll help you add OAuth authentication to your Claude plugin using the MCP (Model Context Protocol) integration skill. I'll provide a comprehensive guide with multiple approaches:\n\n### 1. SSE (Server-Sent Events) OAuth Configuration\n\n```json\n{\n  \"github\": {\n    \"type\": \"sse\",\n    \"url\": \"https://mcp.github.com/sse\",\n    \"oauth\": {\n      \"provider\": \"github\",\n      \"scopes\": [\"repo\", \"read:user\"]\n    }\n  }\n}\n```\n\n### 2. HTTP OAuth Configuration\n\n```json\n{\n  \"asana\": {\n    \"type\": \"http\",\n    \"url\": \"https://app.asana.com/api/v1/mcp\",\n    \"oauth\": {\n      \"provider\": \"asana\",\n      \"scopes\": [\"tasks:read\", \"tasks:write\"],\n      \"token_url\": \"https://app.asana.com/oauth/token\"\n    }\n  }\n}\n```\n\n### Best Practices for OAuth Integration\n\n#### Environment Variable Setup\nCreate a `.env` file or set environment variables:\n```bash\nGITHUB_CLIENT_ID=your_client_id\nGITHUB_CLIENT_SECRET=your_client_secret\n```\n\n#### Plugin Configuration (plugin.json)\n```json\n{\n  \"name\": \"my-github-plugin\",\n  \"version\": \"1.0.0\",\n  \"requiredEnvironment\": [\n    \"GITHUB_CLIENT_ID\",\n    \"GITHUB_CLIENT_SECRET\"\n  ],\n  \"mcpServers\": {\n    \"github\": {\n      \"type\": \"sse\",\n      \"url\": \"https://mcp.github.com/sse\",\n      \"oauth\": {\n        \"provider\": \"github\",\n        \"client_id\": \"${GITHUB_CLIENT_ID}\",\n        \"client_secret\": \"${GITHUB_CLIENT_SECRET}\",\n        \"scopes\": [\"repo\", \"read:user\"]\n      }\n    }\n  }\n}\n```\n\n### Authentication Flow\n\n1. **Initial Connection**\n   - When first using an OAuth-enabled MCP server, Claude Code will:\n     - Open a browser window for user authentication\n     - Request user consent for specified scopes\n     - Store and manage access tokens securely\n\n2. **Token Management**\n   - Tokens are encrypted and stored locally\n   - Automatic refresh for expired tokens\n   - Secure token rotation\n\n### Security Recommendations\n\n\u2705 DO:\n- Use environment variables for credentials\n- Limit OAuth scopes to minimum required\n- Use HTTPS for all OAuth endpoints\n- Document required environment variables\n\n\u274c DON'T:\n- Hardcode client secrets\n- Request unnecessary scopes\n- Use HTTP for authentication\n\n### Example Command with OAuth Tool\n\n```markdown\n# github-create-issue.md\n---\nallowed-tools: [\n  \"mcp__plugin_github_github__create_issue\"\n]\n---\n\n# Create a GitHub Issue\n\nI want to create a new issue in a repository.\n```\n\n### Debugging OAuth\n\n1. Use Claude Code debug mode:\n```bash\nclaude --debug\n```\n\n2. Check OAuth connection:\n```bash\n/mcp show github\n```\n\n### Handling Authentication Errors\n\nIn your commands, include error handling:\n\n```markdown\n# Robust OAuth Tool Usage\n\n1. Check if authenticated\n   - If not, prompt user to (re)authenticate\n2. Catch and handle authentication errors\n3. Provide clear instructions for resolution\n```\n\n### Multi-Service OAuth Example\n\n```json\n{\n  \"mcpServers\": {\n    \"github\": {\n      \"type\": \"sse\",\n      \"oauth\": {\n        \"provider\": \"github\",\n        \"scopes\": [\"repo\"]\n      }\n    },\n    \"asana\": {\n      \"type\": \"http\", \n      \"oauth\": {\n        \"provider\": \"asana\",\n        \"scopes\": [\"tasks:all\"]\n      }\n    }\n  }\n}\n```\n\n### Common OAuth Providers\n\n| Provider | Type | Typical Scopes |\n|----------|------|----------------|\n| GitHub | SSE | repo, user |\n| Asana | HTTP | tasks:read, tasks:write |\n| Slack | SSE | chat:write, channels:read |\n| Google | HTTP | calendar, drive |\n\n### Next Steps\n\n1. Register your application with the service\n2. Obtain client ID and client secret\n3. Configure scopes\n4. Add to plugin configuration\n5. Test authentication flow\n\n### Recommended Resources\n\n- OAuth 2.0 Specification\n- Provider-specific OAuth documentation\n- Claude Code MCP Integration Guide\n\nWould you like me to help you set up OAuth for a specific service or walk you through the process for a particular use case?",
  "skill_tokens": {
    "input": 3657,
    "output": 1116,
    "total": 4773
  },
  "judge_verdict": "with_skill",
  "judge_reasoning": "Response A provides specific, actionable guidance for Claude plugins using MCP (Model Context Protocol) with concrete JSON configurations, environment setup, and Claude-specific implementation details. Response B offers generic OAuth implementation patterns that aren't tailored to Claude plugins specifically. Response A is more complete, thorough, and directly addresses the user's specific use case with ready-to-use code examples.",
  "judge_model": "claude-sonnet-4-20250514",
  "timestamp": "2026-01-01T19:05:50.335760"
}