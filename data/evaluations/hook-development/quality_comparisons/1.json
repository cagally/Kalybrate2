{
  "prompt": "Set up automatic project context loading when starting a new session",
  "baseline_response": "I'll provide a comprehensive solution for setting up automatic project context loading in Emacs. This will help you quickly resume work on specific projects with predefined configurations.\n\n```elisp\n;; Project Context Management\n\n(require 'project)\n(require 'desktop)\n(require 'projectile)\n\n;; Custom project context configuration\n(defcustom my/project-contexts-directory \n  (expand-file-name \"project-contexts\" user-emacs-directory)\n  \"Directory to store project context configurations.\"\n  :type 'directory\n  :group 'my-project-management)\n\n;; Ensure project contexts directory exists\n(unless (file-exists-p my/project-contexts-directory)\n  (make-directory my/project-contexts-directory t))\n\n(defun my/save-project-context ()\n  \"Save the current project's context configuration.\"\n  (interactive)\n  (let* ((project-root (projectile-project-root))\n         (project-name (projectile-project-name))\n         (context-file (expand-file-name \n                        (format \"%s-context.el\" project-name)\n                        my/project-contexts-directory)))\n    (when project-root\n      (with-temp-file context-file\n        ;; Save project-specific configurations\n        (insert\n         (format \";; Project Context for %s\\n\\n\" project-name)\n         (format \"(setq-local default-directory \\\"%s\\\")\\n\" project-root)\n         \n         ;; Save open buffers\n         \"(let ((buffers '(\\n\"\n         (mapconcat \n          (lambda (buffer)\n            (format \"   %S\" (buffer-file-name buffer)))\n          (seq-filter \n           (lambda (b) \n             (and (buffer-file-name b)\n                  (string-prefix-p project-root (buffer-file-name b))))\n           (buffer-list))\n          \"\\n\")\n         \")))\\n\"\n         \n         ;; Restore buffer configuration\n         \"(dolist (file buffers)\\n\"\n         \"  (when (file-exists-p file)\\n\"\n         \"    (find-file-noselect file)))\\n\"\n         \n         ;; Additional project-specific settings\n         (format \"(setq-local compile-command \\\"%s\\\")\\n\" \n                 (or (bound-and-true-p compile-command) \"\"))\n         \n         ;; You can add more project-specific configurations here\n         )))\n      (message \"Project context saved for %s\" project-name))))\n\n(defun my/load-project-context ()\n  \"Load a project context configuration.\"\n  (interactive)\n  (let* ((context-files \n          (directory-files \n           my/project-contexts-directory \n           t \n           \".*-context\\\\.el$\"))\n         (selected-context \n          (completing-read \n           \"Select project context: \" \n           (mapcar #'file-name-nondirectory context-files))))\n    (when selected-context\n      (let ((context-file \n             (expand-file-name \n              selected-context \n              my/project-contexts-directory)))\n        (when (file-exists-p context-file)\n          (load-file context-file)\n          (message \"Loaded project context: %s\" selected-context))))))\n\n(defun my/auto-load-project-context ()\n  \"Automatically load project context if available.\"\n  (when (and (projectile-project-root)\n             (not (minibufferp)))\n    (let* ((project-name (projectile-project-name))\n           (context-file (expand-file-name \n                          (format \"%s-context.el\" project-name)\n                          my/project-contexts-directory)))\n      (when (file-exists-p context-file)\n        (load-file context-file)\n        (message \"Automatically loaded context for %s\" project-name)))))\n\n;; Hooks and keybindings\n(add-hook 'find-file-hook #'my/auto-load-project-context)\n(add-hook 'projectile-after-switch-project-hook #'my/auto-load-project-context)\n\n;; Global keybindings\n(global-set-key (kbd \"C-c p s\") #'my/save-project-context)\n(global-set-key (kbd \"C-c p l\") #'my/load-project-context)\n\n;; Optional: Persist desktop sessions\n(setq desktop-dirname my/project-contexts-directory)\n(setq desktop-base-file-name \"desktop\")\n(setq desktop-base-lock-name \"desktop.lock\")\n(desktop-save-mode 1)\n\n;; Provide the package\n(provide 'my-project-context)\n```\n\nThis comprehensive solution offers several key features:\n\n1. **Project Context Saving**\n   - Save project-specific configurations\n   - Capture open buffers within the project\n   - Store compile commands\n   - Easily extensible for more project-specific settings\n\n2. **Automatic Context Loading**\n   - Automatically detect and load context when entering a project\n   - Works with Projectile for project detection\n   - Supports manual context loading via interactive functions\n\n3. **Flexible Configuration**\n   - Customizable directory for storing project contexts\n   - Interactive selection of project contexts\n   - Hooks for automatic loading\n\n4. **Keybindings**\n   - `C-c p s`: Save current project context\n   - `C-c p l`: Load a project context\n\n5. **Desktop Persistence**\n   - Optional desktop session persistence\n   - Saves and restores session state\n\n**Installation and Usage**:\n\n1. Add the code to your Emacs configuration\n2. Ensure you have Projectile installed\n3. Use `M-x my/save-project-context` to save a project's context\n4. Use `M-x my/load-project-context` to manually load a context\n5. Contexts will automatically load when entering a project\n\n**Customization**:\n- Modify `my/project-contexts-directory` to change the storage location\n- Extend the context saving function to include more project-specific settings\n\n**Pro Tips**:\n- Works best with Projectile for project root detection\n- Can be extended to include more complex project configurations\n- Helpful for managing multiple project environments\n\nEnjoy seamless project context management in Emacs! \ud83d\ude80\ud83d\udda5\ufe0f",
  "baseline_tokens": {
    "input": 18,
    "output": 1541,
    "total": 1559
  },
  "skill_response": "I'll help you set up automatic project context loading when starting a new session using a SessionStart hook. I'll provide a comprehensive example that demonstrates best practices for context loading.\n\n1. First, let's create a context loading script:\n\n```bash\n#!/bin/bash\n# ${CLAUDE_PLUGIN_ROOT}/scripts/load-project-context.sh\nset -euo pipefail\n\n# Ensure the script is only run during SessionStart\nif [ -z \"${CLAUDE_ENV_FILE:-}\" ]; then\n  echo \"Error: This script should only be run during SessionStart\" >&2\n  exit 1\nfi\n\n# Project context detection\nPROJECT_ROOT=\"${CLAUDE_PROJECT_DIR}\"\n\n# Detect project type\nif [ -f \"$PROJECT_ROOT/package.json\" ]; then\n  PROJECT_TYPE=\"nodejs\"\n  PROJECT_DEPENDENCIES=$(jq -r '.dependencies | keys[]' \"$PROJECT_ROOT/package.json\" || echo \"\")\nelif [ -f \"$PROJECT_ROOT/pyproject.toml\" ]; then\n  PROJECT_TYPE=\"python\"\n  PROJECT_DEPENDENCIES=$(grep \"^name =\" \"$PROJECT_ROOT/pyproject.toml\" || echo \"\")\nelif [ -f \"$PROJECT_ROOT/go.mod\" ]; then\n  PROJECT_TYPE=\"golang\"\n  PROJECT_DEPENDENCIES=$(go list -m all | xargs basename || echo \"\")\nelif [ -f \"$PROJECT_ROOT/pom.xml\" ]; then\n  PROJECT_TYPE=\"java\"\n  PROJECT_DEPENDENCIES=$(xpath -q -e \"//dependency/artifactId/text()\" \"$PROJECT_ROOT/pom.xml\" || echo \"\")\nelse\n  PROJECT_TYPE=\"unknown\"\n  PROJECT_DEPENDENCIES=\"\"\nfi\n\n# Load additional context files\nREADME_SUMMARY=\"\"\nif [ -f \"$PROJECT_ROOT/README.md\" ]; then\n  README_SUMMARY=$(head -n 10 \"$PROJECT_ROOT/README.md\" | grep -v \"^$\" | tr '\\n' ' ' | cut -c1-500)\nfi\n\n# Prepare environment variables\n{\n  echo \"export CLAUDE_PROJECT_TYPE=$PROJECT_TYPE\"\n  echo \"export CLAUDE_PROJECT_DEPENDENCIES='$PROJECT_DEPENDENCIES'\"\n  echo \"export CLAUDE_PROJECT_README_SUMMARY='$README_SUMMARY'\"\n} >> \"$CLAUDE_ENV_FILE\"\n\n# Optional: Load project-specific configuration\nCONFIG_FILE=\"$PROJECT_ROOT/.claude/config.json\"\nif [ -f \"$CONFIG_FILE\" ]; then\n  # Extract any project-specific settings\n  CODING_STANDARDS=$(jq -r '.codingStandards // \"\"' \"$CONFIG_FILE\")\n  if [ -n \"$CODING_STANDARDS\" ]; then\n    echo \"export CLAUDE_CODING_STANDARDS='$CODING_STANDARDS'\" >> \"$CLAUDE_ENV_FILE\"\n  fi\nfi\n\n# Log context loading (optional)\necho \"{\n  \\\"systemMessage\\\": \\\"Loaded project context for $PROJECT_TYPE project. Dependencies detected: $PROJECT_DEPENDENCIES\\\",\n  \\\"continue\\\": true\n}\"\n```\n\n2. Create a hooks configuration file:\n\n```json\n{\n  \"description\": \"Automatic project context loader\",\n  \"hooks\": {\n    \"SessionStart\": [\n      {\n        \"matcher\": \"*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"bash ${CLAUDE_PLUGIN_ROOT}/scripts/load-project-context.sh\",\n            \"timeout\": 10\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n3. Make the script executable:\n```bash\nchmod +x ${CLAUDE_PLUGIN_ROOT}/scripts/load-project-context.sh\n```\n\n4. Optional: Create a project-specific configuration file (`.claude/config.json`):\n```json\n{\n  \"codingStandards\": \"Use 2-space indentation, prefer arrow functions in JavaScript, use TypeScript when possible\",\n  \"testCoverage\": \"Aim for >80% unit test coverage\"\n}\n```\n\n## Key Features of this Context Loader\n\n1. **Automatic Project Type Detection**\n   - Identifies project type based on common manifest files\n   - Extracts project dependencies\n   - Supports Node.js, Python, Go, and Java projects\n\n2. **Environment Variable Persistence**\n   - Uses `$CLAUDE_ENV_FILE` to persist context across the session\n   - Sets environment variables like `CLAUDE_PROJECT_TYPE`\n   - Captures project dependencies\n\n3. **README Summary**\n   - Extracts first 10 non-empty lines from README\n   - Truncates to 500 characters to prevent overwhelming context\n\n4. **Project-Specific Configuration**\n   - Optionally loads project-specific settings from `.claude/config.json`\n   - Can set coding standards, test coverage goals, etc.\n\n5. **Error Handling**\n   - Prevents script from running outside SessionStart\n   - Gracefully handles missing files\n   - Provides a system message about loaded context\n\n## Usage in Claude Code Session\n\nWhen you start a new session in a project, this hook will:\n- Automatically detect project type\n- Load project dependencies\n- Extract README summary\n- Set environment variables for use in subsequent interactions\n\n### Example Environment Variables Set\n\n```\nCLAUDE_PROJECT_TYPE=nodejs\nCLAUDE_PROJECT_DEPENDENCIES='react,express,lodash'\nCLAUDE_PROJECT_README_SUMMARY='A web application for task management...'\nCLAUDE_CODING_STANDARDS='Use 2-space indentation, prefer arrow functions...'\n```\n\n## Best Practices and Recommendations\n\n1. Keep the context loading script lightweight\n2. Avoid including sensitive information\n3. Limit the amount of context loaded\n4. Make the script fast (under 10 seconds)\n5. Handle different project structures gracefully\n\n## Debugging\n\nUse `claude --debug` to see detailed logs about context loading. You can also manually test the script:\n\n```bash\nCLAUDE_PROJECT_DIR=/path/to/your/project \\\nCLAUDE_ENV_FILE=$(mktemp) \\\nbash ${CLAUDE_PLUGIN_ROOT}/scripts/load-project-context.sh\n```\n\nThis comprehensive approach provides a flexible, extensible method for automatically loading project context when starting a new Claude Code session.\n\nWould you like me to elaborate on any part of the implementation or discuss how to customize it further for your specific needs?",
  "skill_tokens": {
    "input": 4724,
    "output": 1499,
    "total": 6223
  },
  "judge_verdict": "without_skill",
  "judge_reasoning": "Response A provides a complete, functional Emacs-based solution for automatic project context loading with actual working code that saves/restores buffers, directories, and project settings. Response B appears to be incomplete (cuts off mid-sentence) and focuses on a bash script approach that may not directly address automatic session context loading in the way most users would expect. Response A is more thorough, complete, and directly applicable to the task.",
  "judge_model": "claude-sonnet-4-20250514",
  "timestamp": "2026-01-01T18:59:04.681866"
}